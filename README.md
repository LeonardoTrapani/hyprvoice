# Hyprvoice

> **Voiceâ€‘powered typing for Wayland/Hyprland desktops** â€” press a global shortcut, speak, and watch words appear in whatever window you're focused on.

**ğŸš§ Early Development Status:** This project is currently in early development. Not ready for production use yet.

---

## Why does this hyprvoice exist?

Typing is slow, repetitive strain injuries are real. This project aims to give Wayland users a fast, privacyâ€‘respecting alternative that works entirely on their own hardware _or_ any cloud ASR they trust.

---

## Current Implementation Status

| Component                 | Status  | Description                                                  |
| ------------------------- | ------- | ------------------------------------------------------------ |
| **Hotâ€‘key daemon**        | âœ… Done | Background service with Unix socket IPC for command handling |
| **Desktop notifications** | âœ… Done | Recording state changes via `notify-send`                    |
| **Service management**    | âœ… Done | Install/remove systemd user service with embedded unit file  |
| **Live audio capture**    | ğŸ”„ TODO | PipeWire input with VAD/noise gate                           |
| **ASR backends**          | ğŸ”„ TODO | Local Whisper or cloud APIs (OpenAI, Deepgram, AssemblyAI)   |
| **Text injection**        | ğŸ”„ TODO | `wtype`/`ydotool` keystrokes to focused window               |
| **Configuration**         | ğŸ”„ TODO | TOML config file with runtime reload                         |

---

## QuickÂ Start (Arch / Hyprland)

```bash
# 1. Install from AUR (source build)
yay -S hyprvoice
#Â Â Â or preâ€‘built binary
yay -S hyprvoice-bin

# 2. Run the interactive setup helper
hyprvoice-install run --backend whispercpp

# 3. Enable the user service
systemctl --user enable --now hyprvoice.service

# 4. Add a key binding in Hyprland conf
bind = SUPER, R, exec, hyprvoice toggle
```

---

## Configuration file (`~/.config/hyprvoice/config.toml`)

**Note:** Configuration file support is not yet implemented. This shows the planned format:

```toml
[asr]
backend = "whispercpp"      # whispercpp | openai
model   = "medium.en.bin"   # used if backend = whispercpp
api_key = ""                # used if backend = openai

[vad]
threshold = -45     # dBFS
hang_ms   = 300

[inject]
method = "wtype"   # wtype | ydotool | clipboard

[keybind]
# If you don't use Hyprland, set an XDG desktop accelerator here
shortcut = "CTRL+ALT+SPACE"
```

All options are documented in the sample config generated by `--init`.

---

## Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Unix Socket   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   PCM    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CLI Client   â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ Hotâ€‘key      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚  Audio   â”‚
â”‚ (toggle/stop)â”‚                 â”‚ Daemon       â”‚         â”‚ Capture  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚ (hotkeydaemonâ”‚         â”‚ (pipewireâ”‚
                                 â”‚ + bus)       â”‚         â”‚ + VAD)   â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚                       â”‚
                                        â”‚ notify-send           â”‚ chunks
                                        â–¼                       â–¼
                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                 â”‚ Desktop      â”‚         â”‚   ASR    â”‚
                                 â”‚ Notification â”‚         â”‚ Adapter  â”‚
                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚(whisper/ â”‚
                                                          â”‚ openai)  â”‚
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                 â”‚
                                                                 â”‚ text
                                                                 â–¼
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                          â”‚  Inject  â”‚
                                                          â”‚ (wtype/  â”‚
                                                          â”‚ ydotool) â”‚
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Planned Components:**

- `cmd/hyprvoice`: CLI with Cobra commands (existing: `serve`, `toggle`, `stop`)
- `internal/bus`: Unix socket IPC for daemon communication (âœ… implemented)
- `internal/hotkeydaemon`: Background service managing recording state (âœ… implemented)
- `internal/notify`: Desktop notifications via `notify-send` (âœ… implemented)
- `internal/audiocapture`: PipeWire input with VAD/noise gate (ğŸ”„ TODO)
- `internal/asr`: ASR backends (Whisper, OpenAI, etc.) (ğŸ”„ TODO)
- `internal/inject`: Text injection via wtype/ydotool (ğŸ”„ TODO)
- `internal/config`: TOML configuration with runtime reload (ğŸ”„ TODO)

Each box will be a Go package inside `internal/` so you can swap implementations without touching public APIs.

---

## Building from Source

```bash
git clone https://github.com/leonardotrapani/hyprvoice.git
cd hyprvoice
# Compile
CGO_ENABLED=1 go build -o hyprvoice ./cmd/hyprvoice
# Run tests
go test ./...
```

**Requires** GoÂ 1.22+, a C compiler, and `pkg-config` with PipeWire headers.

---

Contributions welcome! Check the [issues](https://github.com/leonardotrapani/hyprvoice/issues) for good first tasks.

---

## License

This project is licensed under the MIT License. See the [LICENSE.md](LICENSE.md) file for details.
